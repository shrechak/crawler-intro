
(function(window){
	var miootVariables={"partner_id":4364,"skill_id":1,"server_url":"https:\/\/office.mioot.com\/snapdeal\/","ping_interval":20,"invite_ping":20,"chat_ping":10,"status_ping":10,"powered_by":1,"chat_type":1,"max_textarea":750,"max_textbox":60,"web_url":"https:\/\/snapdeal.mioot.com\/","window_type":1};	
	var chatVariables={"partner_id":4364,"skill_id":1,"prechat_msg1":"Now you can chat directly with the seller to resolve any pre-purchase queries that you may have.","prechat_msg2":"The seller may not be able to answer queries regarding any purchases you have already made.","prechat_msg3":"To start chat, please provide the following information","prechat_description":"Prechat desc","offline_description":"Offline now. Please leave a message for the seller.","chat_type":1,"welcome_message":"Online Now","queue_message":"You are in queue and your queue position is {qlength}","loop_message":"We appreciate your Patience. Your current queue position : {qlength}","queue_waittime":300,"holding_interval1":20,"holding_message1":"hm1","holding_interval2":30,"holding_message2":"hm2","redirection_interval":10,"redirection_message":"We are unable to address your Request. Please try again later.","response_control":1,"response_interval":1200,"response_message":"The chat will be discontinued after 60 seconds due to inactivity.","response_endtime":1200,"response_endmessage":"Chat has been disabled due to inactivity.","chat_accept_message":"Your Chat ID: {chatid}","chat_decline_message":"Sorry, due to some technical problem we are unable to process your chat request","chat_forward_message":"Please hold..{agentname} is forwarding this chat session to {fwdagentname}","conference_join_message":"{agentname} has now joined this conference chat session.","conference_left_message":"{agentname} has now left this conference chat session","end_chat_message":"Thank you for using live chat services","file_upload_message":"{agentname} has shared a file","push_url_message":"{agentname} has shared a webpage","chat_close_message":"Seller has lost connection. Please try again later.","offline_closing_message":"Seller has lost connection. Please try again later."};	

function ClassVisitor(){this.visitor_id=0,this.session_id=0,this.chat_id=0,this.operator_id=0,this.visitor_status=0,this.contact_id=0,this.skill_id=0,this.skill_name="",this.skill_status=0,this.rInt=0,this.maxQInt=0,this.rcTimer=0,this.hcnt=1,this.hinterval=0,this.maxQPos=0,this.QLength=0,this.opMsgCount=0,this.ticks=0,this.dcr=0,this.isChatStart=!1,this.long_addedon="",this.added_on="",this.opfname="",this.oplname="",this.first_name="",this.last_name="",this.fname="",this.product_id="",this.prod_name="",this.email_id="",this.cV="",this.req_url="",this.isTyping=0,this.QmsgL=0,this.message="",this.alertMessage="",this.msgWait=0,this.req_time=0,this.server_time=0,this.rated=0,this.agt=1,this.qp=0,this.isSendOffline=!1,this.initialize=function(){}}function arrayUnique(t){return t.sort().filter(function(i,e){return!e||i!=t[e-1]})}function L(){var t=S("sk"),i=new Array,e=0;i=splitFn(t,"_"),e=i.length,e>maxChat&&(e=maxChat);for(var o=0;e>=o;o++)isNull(i[o])||""==i[o]||doCheck(i[o])}function doCheck(t){var i=splitFn(S(t),"_");i.length>0&&(vObj=getVisitor(t),isNull(vObj)&&(vObj=new ClassVisitor),vObj.visitor_id=isNull(i[0])?0:i[0],vObj.session_id=isNull(i[1])?0:i[1],vObj.visitor_id>0&&vObj.session_id>0&&addVisitor(t,vObj))}function splitFn(t,i){var e=t.split(i);return""==e[0]?[]:e}function addVisitor(t,i){try{isNaN(t)||(i.skill_id=parseInt(t),i.email_id=email,i.first_name=fn,isNaN(t)||isNull(sArray[t])||(i.product_id=sArray[t].prodId,i.email_id=""!=sArray[t].buyEmail?sArray[t].buyEmail:email,i.first_name=""!=sArray[t].buyName?sArray[t].buyName:fn,i.prod_name=sArray[t].prodName,i.skill_status=sArray[t].status,i.skill_name=sArray[t].skill_name,i.fname=i.first_name.charAt(0).toUpperCase()),SKILL_MAP[i.visitor_id]=t,i.cV=cV,VISITORs[t]=i)}catch(e){}}function insertCssMioot(t){var i=document.createElement("style");i.type="text/css",i.styleSheet?i.styleSheet.cssText=t:i.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(i)}function scrTag(t,i){try{var e=document.getElementsByTagName("head").item(0);s=document.createElement("script"),s.type="text/javascript",s.defer=!0,s.setAttribute("chatcall","miootOnOffScr"),s.charset="utf-8",s.src=t+"?"+i,s.async=!0,void e.appendChild(s),s=""}catch(o){}}function removeScrTag(){for(var t=document.getElementsByTagName("script"),i=0;i<=t.length;i++)t[i]&&null!=t[i].getAttribute("src")&&"miootOnOffScr"==t[i].getAttribute("chatcall")&&t[i].parentNode.removeChild(t[i])}function LT(){var t=new Date;return t.getTime()}function isNull(t){return null==t||void 0==t?!0:!1}function elemByClass(t,i){for(var e=[],o=document.getElementsByTagName(i),s=new RegExp("(^|\\s)"+t+"(\\s|$)"),a=0;a<o.length;a++)s.test(o[a].className)&&e.push(o[a]);return e}function set(t){ACT_SKILLs[t.skill_id]=t,T(t.skill_id,t.visitor_id+"_"+t.session_id),X()}function clearCook(t){T(t.skill_id,null,0),Hash.remove(ACT_SKILLs,t.skill_id),X()}function X(){T("sk",getKeys(ACT_SKILLs,"_").replace(/_(\s+)?$/,""),0)}function clearDetails(t){Hash.remove(ACT_SKILLs,t),Hash.remove(VISITORs,t)}function S(t){t=zz+mV.partner_id+"_"+t;var i,e,o,s=document.cookie;if(s)for(t+="=",s=s.split(";"),o=0;o<s.length;o++)if(i=s[o],e=i.indexOf(t),e>=0)return unescape(i.substring(e+t.length,i.length));return""}function T(t,i,e){t=zz+mV.partner_id+"_"+t;var o,s="";e&&(o=new Date,e=24*e*60*60*1e3,o.setTime(o.getTime()+e),s="; expires="+o.toGMTString()),document.cookie=t+"="+escape(i)+s+"; path=/;"}function getVisitor(t){return VISITORs[t]}function vPingStart(){clearInt(pingInt),pingInt=setInterval(function(){visitorPing()},1e3*mV.ping_interval),IamLive()}function visitorPing(){if(isLastPingExceed())for(var t in VISITORs)vObj=VISITORs[t],15==vObj.visitor_status&&chatEndResponse(vObj,1);IamLive()}function chatPingStart(){cpInt>0||(chatPing(),cpInt=setInterval(function(){chatPing()},3e3))}function chatPing(){var t=!1;for(key in VISITORs){var i=VISITORs[key];7==i.visitor_status||8==i.visitor_status||11==i.visitor_status||13==i.visitor_status?(visitorIsAccepted(i),t=!0):9==i.visitor_status?(visitorQPos(i),t=!0):15==i.visitor_status&&(vGetChatMessage(i),t=!0)}t||(clearInt(cpInt),cpInt=0)}function IamLive(){var t=getParams(VISITORs);""!=t?(para='visitors={"partner_id":'+mV.partner_id+',"vistorList":['+t+'],"time":'+LT()+"}",scrTag(url+urls.rUrl30,para)):clearInt(pingInt)}function getParams(t){hmsg="";for(var i in t)t[i].visitor_id>0&&(hmsg+=par(t[i])+",");return hmsg.slice(0,-1)}function par(t){return'{"visitor_id":'+t.visitor_id+',"session_id":'+t.session_id+',"skill_id":'+t.skill_id+"}"}function startAcceptedPing(t){visitorIsAccepted(t),t.rInt=setInterval(function(){visitorIsAccepted(t)},5e3)}function startQueuePosPing(t){t.rInt=setInterval(function(){visitorQPos(t)},3e3)}function tIndStart(t){1==t.cV.typing_indicator&&(pTypingLen=t.message.length,pStateTyping=!1,clearInt(tInt),tInt=setInterval(function(){typingIndicate()},1e4))}function onOffPingStart(t){mInt=setInterval(function(){onOffMultiple(t)},1e3*mV.status_ping)}function onOffMultiple(t){var i='visitorparams={"partner_id":'+mV.partner_id+',"skillids":"('+t+')","time":'+LT()+"}";scrTag(url+urls.rUrl2,i)}function getChatMessageStart(t){clearInt(t.rInt),t.rInt=setInterval(function(){vGetChatMessage(t)},1e3*mV.chat_ping),1==t.cV.typing_indicator&&t.skill_id==selected_skill&&tIndStart(t)}function visitorRequestChat(t){para="visitorinformation={"+CP(t)+',"contact_id":'+t.contact_id+',"requested_by":1,"requestedUrl":"'+t.req_url+'","operator_id":'+t.dcr+',"time":'+LT()+"}",scrTag(url+urls.rUrl12,para)}function visitorIsAccepted(t){para="visitorparams={"+CP(t)+"}",scrTag(url+urls.rUrl13,para)}function vGetChatMessage(t){para='chatmessage={"partner_id":'+mV.partner_id+',"sender_id":'+t.visitor_id+',"session_id":'+t.session_id+',"chat_id":'+t.chat_id+',"added_on":"'+t.added_on+'","longAddedOn":'+t.long_addedon+',"time":'+LT()+"}",scrTag(url+urls.rUrl15,para)}function visitorQPos(t){para="visitorparams={"+CP(t)+"}",scrTag(url+urls.rUrl16,para)}function sendPreChat(t){para='prechat={"partner_id":'+mV.partner_id+',"skill_id":'+t.skill_id+',"first_name":"'+esc(t.first_name)+'","email_id":"'+esc(t.email_id)+'","unique_id":"email_id","custom_field1":'+t.product_id+',"custom_field2":"'+esc(t.prod_name)+'","custom_enabled":true,"url":"'+URLEnc(window.location.toString())+'","time":'+LT()+"}",scrTag(url+urls.rUrl29,para)}function sendOffline(t){para='ticketinfo={"partner_id":'+mV.partner_id+',"skill_id":1,"first_name":"'+esc(t.first_name)+'","email_id":"'+esc(t.email_id)+'","unique_id":"email_id","custom_enabled":true,"eticket_id":1,"ticket_subject":"'+enc(tSub)+'","tof":1,"message_type":1,"ticket_message":"'+URLEnc(t.message)+'","time":'+LT()+"}",scrTag(url+urls.rUrl18,para),t.alertMessage=t.cV.offline_closing_message,showhideAlert(t.skill_id,t.alertMessage)}function getMultiChatMessages(t){para='chatmessage={"partner_id":'+mV.partner_id+',"visitorsChatMessageBeanList":['+t+'],"time":'+LT()+"}",scrTag(url+urls.rUrl28,para)}function visitorChatEnd(t){para="visitorparams={"+CP(t)+',"chat_id":'+t.chat_id+',"operator_id":'+t.operator_id+"}",scrTag(url+urls.rUrl20,para)}function sendMsgToServer(t,i){para='message={"partner_id":'+mV.partner_id+',"sender_id":'+t.visitor_id+',"session_id":'+t.session_id+',"chat_id":'+t.chat_id+',"message":"'+URLEnc(t.message)+'","message_type":'+i+',"senderType":1,"time":'+LT()+"}",scrTag(url+urls.rUrl17,para)}function maxQRedirect(t){t.visitor_status=20,para="abandonedChatBean={"+CP(t)+',"chat_id":0,"operator_id":0,"reason_code":3,"queue_position":'+t.maxQPos+"}",scrTag(url+urls.rUrl22,para),showhideAlert(t.skill_id,replaceVars(t.cV.redirection_message,t)),t.qpos=0,clearCook(t)}function closedOnQ(t){t.visitor_status=20,para="abandonedChatBean={"+CP(t)+',"chat_id":0,"operator_id":0,"reason_code":2,"queue_position":'+t.maxQPos+"}",scrTag(url+urls.rUrl22,para)}function QFullRedirect(t){t.visitor_status=20,showhideAlert(t.skill_id,replaceVars(t.cV.redirection_message,t))}function noResponse(t){para="abandonedChatBean={"+CP(t)+',"chat_id":'+t.chat_id+',"operator_id":'+t.operator_id+',"reason_code":8}',scrTag(url+urls.rUrl22,para)}function nonQRedirect(t){var i="";stopInterval(t),t.visitor_status=20,clearCook(t),i=t.dcr>0?"{"+CP(t)+',"chat_id":0,"operator_id":'+t.dcr+',"reason_code":5}':"{"+CP(t)+',"chat_id":0,"operator_id":0,"reason_code":4}',para="abandonedChatBean="+i,scrTag(url+urls.rUrl22,para),showhideAlert(t.skill_id,replaceVars(t.cV.redirection_message,t))}function cancelled(t){stopInterval(t),t.visitor_status=14,para="abandonedChatBean={"+CP(t)+',"chat_id":0,"reason_code":10}',scrTag(url+urls.rUrl22,para)}function noResponse(t){para="abandonedChatBean={"+CP(t)+',"chat_id":'+t.chat_id+',"operator_id":'+t.operator_id+',"reason_code":8}',scrTag(url+urls.rUrl22,para)}function vSendRating(t,i){para="visitorparams={"+CP(t)+',"chat_id":'+t.chat_id+',"visitorRating":'+i+',"time":'+LT()+"}",scrTag(url+urls.rUrl26,para)}function skillMap(t){para='visitorparams={"partner_id":'+mV.partner_id+',"lstSkillCode":['+t+'],"time":'+LT()+"}",scrTag(url+urls.rUrl32,para)}function stopInterval(t){stopHolding(t)}function clearInt(t){clearInterval(t),t=0}function CP(t){return'"partner_id":'+mV.partner_id+',"visitor_id":'+t.visitor_id+',"session_id":'+t.session_id+',"skill_id":'+t.skill_id+',"time":'+LT()}function reloadMessage(t){var i='<span id="'+zz+"chat_again_"+t.skill_id+'">';return 1==sArray[t.skill_id].status&&(i+=cAgain()+"</span>"),i+="</span>"}function cAgain(){return'<a href="javascript:void(0)" onclick="miootChat.chatAgain();" /> Chat Again</a>'}function chatEndResponse(t,i){t.visitor_status=19,t.rated=-1,clearCook(t),clearInt(tInt),stopResponseControl(t),hmsg="",1==i?(t.ticks>t.cV.response_buffer_time&&0==t.opMsgCount&&noResponse(t),hmsg=replaceVars(t.cV.end_chat_message,t)):0==i&&(hmsg=replaceVars(t.cV.chat_close_message,t),hmsg+=reloadMessage(t),0==t.opMsgCount&&noResponse(t)),showhideAlert(t.skill_id,hmsg),t.skill_id==selected_skill&&disableTypepad(!0)}function continueChat(t){if(welcomeMsg(t),vs=t.visitor_status,7==vs||8==vs)t.hcnt=1,holdMsgContinue(t),startAcceptedPing(t);else if(11==vs||13==vs)startAcceptedPing(t);else if(9==vs){startQueuePosPing(t);var i=getElapsedTime(t);i=i<t.cV.queue_waittime?t.cV.queue_waittime-i:1,t.maxQInt=setTimeout(function(){maxQRedirect(t)},1e3*i)}else setDefaultWin(t)}function start(){onLoad=!1,miootChatCall(),VISITORs.length>0&&(getMultiChatMessages(getParams(VISITORs)),vPingStart())}function miootChatCall(){if(isNull(EID(zz+"chat_call"))){var t=document.createElement("div");t.id=zz+"chat_call",t.style.display="none",t.innerHTML=chatWinDesign,document.body.appendChild(t),t.innerHTML+="<audio src="+imgPath+'sound.mp3 id="mioot_audio" preload="auto"></audio>',setTimeout(function(){addEvents()},1e3)}}function addEvents(){window.addEventListener?(EID(zz+"top_close1").addEventListener("click",function(){miootChat.topClose()},!1),EID(zz+"top_close2").addEventListener("click",function(){miootChat.topClose()},!1),EID(zz+"minimize").addEventListener("click",function(){miootChat.setMinMax(0)},!1),EID(zz+"maximize").addEventListener("click",function(){miootChat.setMinMax(1)},!1),EID(zz+"btn_send").addEventListener("click",function(){miootFunctions.fn.sendmsg()},!1)):window.attachEvent&&(EID(zz+"top_close1").attachEvent("onclick",function(){miootChat.topClose()}),EID(zz+"top_close2").attachEvent("onclick",function(){miootChat.topClose()}),EID(zz+"minimize").attachEvent("onclick",function(){miootChat.setMinMax(0)}),EID(zz+"maximize").attachEvent("onclick",function(){miootChat.setMinMax(1)}),EID(zz+"btn_send").attachEvent("onclick",function(){miootFunctions.fn.sendmsg()}))}function build(t){try{isNull(t)||isNull(VISITORs[t.skill_id])||(isChatted=!0,miootChat.addSkill(t.skill_id,t.skill_name,t.skill_status),t.opfname=t.skill_name.charAt(0).toUpperCase(),vs=t.visitor_status,showhide(zz+"chat_call",!0),miootChat.setMinMax(1))}catch(i){}}function setDefaultWin(t){1==t.skill_status?sendPreChat(t):offlineform(t,1)}function isLastPingExceed(){var t=S("lp"),i=parseInt((LT()-t)/1e3);return 0==t||i>lpDuration?!0:!1}function stopResponseControl(t){clearInt(t.rcTimer),clearAlert(t)}function clearAlert(t){t.alertMessage=""}function disp(t,i){""!=i&&(i=replaceVars(i,t),sysMsg(t,i))}function holdingMessage(t,i,e){7==e.visitor_status||8==e.visitor_status?(cV=e.cV,disp(e,t),e.hinterval=1==e.hcnt?setTimeout(function(){holdingMessage(cV.holding_message1,0,e)},1e3*(cV.holding_interval1-i)):2==e.hcnt?setTimeout(function(){holdingMessage(cV.holding_message2,0,e)},1e3*(cV.holding_interval2-i)):setTimeout(function(){nonQRedirect(e),offlineform(e,1)},1e3*(cV.redirection_interval-i)),e.elapsed=0,e.hcnt++):stopHolding(e)}function stopHolding(t){clearTimeout(t.hinterval)}function holdMsgContinue(t){var i=getElapsedTime(t),e=t.cV.holding_interval1+t.cV.holding_interval2;elapsed=0,i<=t.cV.holding_interval1?(t.hcnt=1,elapsed=i,holdingMessage("",i,t)):i>t.cV.holding_interval1&&e>=i?(t.hcnt=2,elapsed=i-t.cV.holding_interval1,holdingMessage(t.cV.holding_message1,elapsed,t)):(t.hcnt=3,disp(t,t.cV.holding_message1),elapsed=i<e+t.cV.redirection_interval?i-e:e,holdingMessage(t.cV.holding_message2,elapsed,t))}function getElapsedTime(t){return(t.server_time-t.req_time)/1e3}function avgQWT(t,i,e){var o=0;t>0&&i>0&&(o=i*e.cV.avgCT/t),hmsg=e.cV.queue_message.replace("{qlength}",i).replace("{WaitTime}",o),sysMsg(e,'<div id="'+zz+"queue"+e.skill_id+'">'+hmsg+"</div>"),e.QLength=i}function declineChat(t){stopHolding(t),t.hcnt=1,hmsg=replaceVars(t.cV.chat_decline_message,t),AddToBrowser(t.skill_id,hmsg)}function offlineform(t){t.visitor_status=20}function chatSettings(t){acceptMsg(t)}function getSkillID(t){return isNull(SKILL_MAP[t])?0:SKILL_MAP[t]}function EID(t){return document.getElementById(t)}function remElement(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function closeWin(){EID(zz+"inner").innerHTML="",EID(zz+"skill_online").innerHTML="",EID(zz+"skill_offline").innerHTML="",showhide(zz+"chat_call",!1)}function esc(t){return URLEnc(escapeHtml(enc(t)))}function URLEnc(t){return encodeURIComponent(t)}function enc(t){t=t.replace(/\n/g,"<br/>").replace(/\r\n/g,"<br/>").replace(/\<br\/\>/g,"||br||").replace(/\<br \/\>/g,"||br||").replace(/\<br\>/g,"||br||");var i=/<(\n)+?>/gi;return t=t.replace(i," ").replace(/\|\|br\|\|/g,"<br/>").replace(/^\s+|\s+$/g,"")}function escapeHtml(t){return t.replace(/&(?!amp;)/g,"&amp;").replace(/<(?!lt;)/g,"&lt;").replace(/>(?!gt;)/g,"&gt;").replace(/"(?!quot;)/g,"&quot;").replace(/'(?!#039;)/g,"&#039;")}function decodeHTML(t){return t.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")}function fulltrim(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function checkPhoneInString(t){t=t.replace(/\s/g,""),t=t.replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi,"");var i=/\d{8}/;return i.test(t)}function checkEmailInString(t){var i=/\S+@\S+\.\S+/;return i.test(t)}function validMsg(t){return checkPhoneInString(t)?(showhideAlert(selected_skill,aL.A34),!1):checkEmailInString(t)?(showhideAlert(selected_skill,aL.A35),!1):!0}function sendmsg(){try{var t=EID(zz+"typepad").value;if(t=fulltrim(t),t.length>maxMsgLength)return void showhideAlert(selected_skill,aL.A33+maxMsgLength);if(t.length>0){if(vObj=getVisitor(selected_skill),!validMsg(t,vObj))return;if(dispMsg=t,t=enc(escapeHtml(t)),15==vObj.visitor_status)dispMsg=enc(escapeHtml(dispMsg)),AddToBrowser(selected_skill,vSendMsg(vObj,dispMsg)),stopResponseControl(vObj),showhideAlert(vObj.skill_id,""),vObj.message=t,sendMsgToServer(vObj,1),pTypingLen=0,pStateTyping=!1,vObj.message="";else{if((9==vObj.visitor_status||7==vObj.visitor_status||8==vObj.visitor_status||11==vObj.visitor_status)&&t.length>0)return saveMsgInQ(dispMsg,vObj),void showhideAlert(vObj.skill_id,"");(0==vObj.skill_status||20==vObj.visitor_status)&&(vObj.message="",vObj.isSendOffline=!0,disableTypepad(!0))}}EID(zz+"typepad").value="",editor(1)}catch(i){}}function editor(t){1==t?showhide(zz+"eright",!1):showhide(zz+"eright",!0)}function saveMsgInQ(t,i){return i.QmsgL=i.QmsgL+t.length,i.QmsgL>maxMsgLength?(disableTypepad(!0),dispMsg="<font style='color:red;'>'"+aL.A24+"'</font><br>",void showhideAlert(i.skill_id,dispMsg)):(t=fulltrim(t),i.message=i.message+escapeHtml(enc(t))+"<br />",AddToBrowser(i.skill_id,vSendMsg(i,enc(escapeHtml(t)))),void(EID(zz+"typepad").value=""))}function sendMsgInQ(t){sendMsgToServer(t,1),t.message="",t.QmsgL=0}function typingIndicate(){var t=0;if(!isNull(EID(zz+"typepad"))){var i=fulltrim(EID(zz+"typepad").value).length;!pStateTyping&&i!=pTypingLen&&i>0?(t=14,pStateTyping=!0):pStateTyping&&(0==i||i==pTypingLen)&&(t=20,pStateTyping=!1),pTypingLen=i,t>0&&(vObj=getVisitor(selected_skill),15==vObj.visitor_status&&(vObj.message=""),sendMsgToServer(vObj,t))}}function acceptMsg(t){hmsg=replaceVars(t.cV.chat_accept_message,t),sysMsg(t,hmsg)}function welcomeMsg(t){hmsg=replaceVars(t.cV.welcome_message,t),sysMsg(t,'<div class="mioot_dep_name" title="'+t.skill_name+'">'+t.skill_name+"</div>"+hmsg)}function responseCtrlEnd(t){visitorChatEnd(t),chatEndResponse(t,1),hmsg=replaceVars(t.cV.response_endmessage,t),hmsg+=reloadMessage(t),t.alertMessage=hmsg,showhideAlert(t.skill_id,t.alertMessage),miootChat.setFocus(t.skill_id)}function DLink(t,i,e){i=i.split(",");var o="<a href='"+i[0]+"' target='_blank'> "+i[1]+"</a>";return hmsg=1==e?vMsg(t,"Uploaded "+o):agentMsg(t.fname,"Uploaded "+o)}function WinOpen(t){window.open(t,"_blank");window.focus()}function PushURL(t,i){var e=i.split(","),o=e[0],s=e[1];return hmsg=replaceVars(t.cV.push_url_message,t),e[1]=agentMsg(t.opfname,hmsg+"  <a href='"+o+"' target='_blank'>"+s+"</a>"),e}function PushImage(t,i){var e=i.split(",");return agentMsg(t.opfname,"<img src='"+e[0]+"' border='0'/>")}function createElem(t){return document.createElement(t)}function scrollDown(t){t.scrollTop=t.scrollHeight}function AddToBrowser(t,i){cWobj=EID(zz+"chat_"+t),isNull(cWobj)||(cWobj.innerHTML+=i,scrollDown(cWobj))}function disableTypepad(t){var i=EID(zz+"typepad");i.disabled=t,t?(i.placeholder="",EID(zz+"editor").className=zz+"editor_inactive"):(i.placeholder="Send a message ...",i.focus(),EID(zz+"editor").className=zz+"editor_active")}function agentMsg(t,i){return'<div class="'+zz+'agent"><div class="mioot-img mioot-agent_bubble"><div class="'+zz+'agent_name">'+t+'</div></div><div class="'+zz+'agent_msg"><div class="'+zz+'agent_text">'+i+'</div><div class="'+zz+'agent_time">Seller says... | '+getLocalTime()+"</div></div></div>"}function vMsg(t,i){return formatVMsg(t,i)+'<div class="'+zz+'visitor_time">'+t.first_name+" says... | "+toLocalTime(t.added_on)+"</div></div>"}function sysMsg(t,i){isNull(EID(zz+"sysmsg_"+t.skill_id))?(hmsg='<div class="'+zz+'agent"><div class="mioot-img mioot-agent_bubble '+zz+'agent_name">'+t.opfname+'</div><div class="'+zz+'sys_div"> <div id="'+zz+"sysmsg_"+t.skill_id+'" class="'+zz+'sys_msg">'+i+"</div> </div></div>",AddToBrowser(t.skill_id,hmsg)):EID(zz+"sysmsg_"+t.skill_id).innerHTML+="<div>"+i+"</div>"}function vSendMsg(t,i){return formatVMsg(t,i)+'<div class="'+zz+'visitor_time">'+t.first_name+" says... | "+getLocalTime()+"</div></div></div>"}function formatVMsg(t,i){return'<div class="'+zz+'visitor"><div class="mioot-img mioot-visitor-bubble"><div class="'+zz+'visitor_name">'+t.fname+'</div></div><div class="'+zz+'visitor_msg"><div class="'+zz+'visitor_text">'+i+"</div>"}function toLocalTime(t){return gTime(new Date(t+=" GMT").toLocaleTimeString())}function getLocalTime(){return gTime((new Date).toLocaleTimeString())}function gTime(t){return t.replace(/:(\d{2}) (?=[AP]M)/," ")}function activeClass(t){return 1==t?"mioot-img mioot_onActive skillinner":"mioot-img mioot_offActive skillinner"}function inActiveClass(t){return 1==t?"mioot-img mioot_online skillinner":"mioot-img mioot_offline skillinner"}function removeSelection(){}function getElemByClass(t){return document.querySelectorAll("."+t)}function gotoFirst(){var t=getElemByClass(zz+"chatcall");t.length>0?miootChat.setFocus(t[0].getAttribute("skill")):(selected_skill=0,closeWin())}function replaceVars(t,i){return t.replace("{agentname}",i.opfname).replace("{fname}",i.first_name).replace("{lname}",i.last_name).replace("{chatid}",i.chat_id).replace("{skill_name}","").replace("{time}",i.cV.response_interval+i.cV.response_endtime)}function showhideAlert(t,i){""!=i?(EID(zz+"chat_"+t).className=zz+"chatmsgAlert",showhide(zz+"alert_"+t,!0),EID(zz+"alert_msg"+t).innerHTML=i):(EID(zz+"chat_"+t).className=zz+"chatmsg",EID(zz+"alert_msg"+t).innerHTML="",showhide(zz+"alert_"+t,!1))}function showhide(t,i){EID(t).style.display=i?"block":"none"}function showRatingOLD(t){EID(zz+"survey").innerHTML=t.rated>0?aL.A32:aL.A31+'<span class="mioot-img mioot-zthumbs-up" onClick="miootOFn.rateThis(1)"></span>|<span class="mioot-img mioot-zthumbs-down" onClick="miootOFn.rateThis(2)"></span>',showhide(zz+"survey",!0)}function showRating(t){EID(zz+"survey").innerHTML=t>0?aL.A32:0==t?aL.A31+'<span class="mioot-img mioot-zthumbs-up" onClick="miootOFn.rateThis(1)"></span>|<span class="mioot-img mioot-zthumbs-down" onClick="miootOFn.rateThis(2)"></span>':""}function opTyping(t){selected_skill==t.skill_id&&1==t.isTyping&&(EID(zz+"typing_"+t.skill_id).innerHTML='<div class="mioot_typing_dot mioot-img mioot-ztyping"></div>',setTimeout(function(){clearTyping(t)},5e3))}function clearTyping(t){t.isTyping=0,t.skill_id==selected_skill&&(EID(zz+"typing_"+t.skill_id).innerHTML="")}function chatEndProcess(t){clearCook(t),9==t.visitor_status?closedOnQ(t):7==t.visitor_status||8==t.visitor_status?cancelled(t):15==t.visitor_status&&(visitorChatEnd(t),chatEndResponse(t,1)),miootChat.removeChatDiv(t.skill_id)}function dispErr(t,i){""!=i?(EID(t).innerHTML=i,showhide(t,!0)):""==i&&(EID(t).innerHTML="",showhide(t,!1))}function isMaxLenExceed(t,i){return t.length>i?!0:!1}function getKeys(t,i){var e="";for(var o in t)e+=o+i;return e.replace(/,(\s+)?$/,"")}function setHTML(t,i){isNull(t)||(t.innerHTML=i)}function Hash(){}var urls={rUrl2:"OnOffMultiple",rUrl3:"vlogin",rUrl9:"visitorPing",rUrl12:"visitorRequestChat",rUrl13:"visitorIsAccepted",rUrl15:"visitorgetChatMessage",rUrl16:"visitorQueuePosition",rUrl17:"visitorSendMessage",rUrl18:"addTicket",rUrl20:"visitorChatEnd",rUrl22:"visitorAbandonedChat",rUrl26:"visitorChatRating",rUrl28:"snapDealGetChatMessages",rUrl29:"snapDealPreChatdata",rUrl30:"snapDealVisitorPing",rUrl32:"SnapdealOnOffMultiple"},alert_message={A1:"Required",A2:"Invalid Input",A3:"Invalid Email",A6:"Numbers and alphabets only",A7:"Max length exceeded",A8:"START CHAT! >",A12:"Are you sure to close?",A23:"{agent} is typing...",A24:"You have exceeded the maximum character limit. Please wait for an agent to join you to continue",A31:"Was chat with this seller helpful?",A32:"Thank you for your Feedback",A33:"Message length exceeded the maximun limit : ",A34:"Phone numbers can not be Posted",A35:"E-mail IDs can not be Posted"},mV=miootVariables,cV=chatVariables,url=mV.server_url,aL=alert_message,lpDuration=50,skill_status=0,vObj=null,hmsg="",selected_skill=0,maxMsgLength=500,cWobj=null,sVObj=null,pStateTyping=!1,pTypingLen=0,tInt=0,pingInt=0,lp=0,mInt=0,para="",isChatted=!1,pSkill=0,imgPath="//snapdeal.mioot.com/images/",onlineImg="online.jpg",offlineImg="offline.jpg",s="",onOffInt=0,vs=0,fn="",email="",zz="mioot_",soundEnable=!1,VISITORs=[],ACT_CHAT={},SKILL_MAP=[],sArray={},sCodes={},ACT_SKILLs=[],maxChat=4,onLoad=!0,cpInt=0,tSub="Hello",mioot_css='.mioot-img{ background: url("'+imgPath+'sprite.png") no-repeat top left; display:inline-block;}  .mioot-agent_bubble { background-position: 0 0;  width:37px; height:38px; float:left; } .mioot-alert_bubble{ background-position: -38px 0; width: 27px; height: 33px; background-repeat:no-repeat;  } .mioot-chat-button{ background-position: -66px 0; width: 45px; height: 32px; } .mioot-close{ background-position: -112px 0; width: 18px; height: 16px; cursor:pointer;} .mioot-counter{ background-position: -131px 0; width: 19px; height: 22px; } .mioot-error{ background-position: -151px 0; width: 28px; height: 22px; } .mioot-online-logo{ background-position: -180px 0; width: 128px; height: 31px; } .mioot-minimize{ background-position: -333px 0; width: 19px; height: 16px; cursor:pointer;} .mioot-offline{ background-position: -353px 0; width: 26px; height: 25px; cursor:pointer;} .mioot-offlineActive_bg{ background-position: -380px 0; width: 160px; height: 30px; } .mioot-offline_bg{ background-position: -541px 0; width: 160px; height: 23px; } .mioot-online{ background-position: -702px 0; width: 21px; height: 19px; } .mioot-onlineActive_bg{ background-position: -724px 0; width: 160px; height: 30px; } .mioot-online_bg{ background-position: -885px 0; width: 160px; height: 23px; } .mioot-sd_logo{ background-position: -1046px 0; width: 34px; height: 30px; } .mioot-skill-close{ background-position: -1081px 0; width: 13px; height: 12px; } .mioot-start-chat{ background-position: -1095px 0; width: 180px; height: 39px; } .mioot-visitor-bubble{ background-position: -1276px 0; width: 37px; height: 38px;float:right;} .mioot-zthumbs-down{ background-position: -1314px 0; width: 20px; height: 18px; vertical-align: middle;cursor:pointer;} .mioot-zthumbs-up{ background-position: -1335px 0; width: 20px; height: 18px; vertical-align: middle;cursor:pointer;} .mioot-ztyping{ background-position: -1356px 0; width: 83px; height: 10px; } .mioot-onoffLogo {background-position: -180px 0; width: 128px; height: 31px; margin:2px 0 0 2px;} #mioot_max_div{ height:415px; width:465px; border-top-right-radius:7px; vertical-align:baseline; right:3px; bottom:30px; position: fixed;background-color:#F1F1F1; -moz-box-shadow:-1px -1px 7px #B7B7B7; -webkit-box-shadow:-1px -1px 7px #B7B7B7; box-shadow: -1px -1px 7px #B7B7B7; zoom: 1; filter: progid:DXImageTransform.Microsoft.Shadow(color=#B7B7B7,direction=0,strength=1),  progid:DXImageTransform.Microsoft.Shadow(color=#B7B7B7,direction=45,strength=2), progid:DXImageTransform.Microsoft.Shadow(color=#B7B7B7,direction=90,strength=2), progid:DXImageTransform.Microsoft.Shadow(color=#B7B7B7,direction=135,strength=0), progid:DXImageTransform.Microsoft.Shadow(color=#B7B7B7,direction=180,strength=0), progid:DXImageTransform.Microsoft.Shadow(color=#B7B7B7,direction=225,strength=2), progid:DXImageTransform.Microsoft.Shadow(color=#B7B7B7,direction=270,strength=2), progid:DXImageTransform.Microsoft.Shadow(color=#B7B7B7,direction=315,strength=1);  } #mioot_title{ height:42px; background-color:#FFFFFF; border-top-left-radius: 7px; border-top-right-radius:5px;} #mioot_logo{ height:38px; margin-left:5px; margin-top:5px; color:#666; float:left;} #mioot_closer{padding-right:3px; padding-top:12px; float:right; }  #mioot_prechat{ height:363px; width:465px; background-color:#F1F1F1; font-family:Calibri,Arial; display:none;position:absolute; } .mioot_pchatguest{ margin:13px 46px 17px 48px; height:343px; background:#FFF; border-radius: 2px; } .mioot_pchatlogged{ margin:65px 46px 67px 48px; background:#FFF; height:241px; padding:0 25px 0 5px; border-radius: 2px;} #mioot_guestform{display:none;}  .mioot_prechatmsg{font-size:17px; font-weight:bold; margin:0px 0 0 16px; color:#000; padding-top:11px;} .mioot_prechatmsg1{ margin:5px 0 0 16px; font-size:18px; color:#000;} .mioot_prechatmsg2{ margin:5px 0 0 16px; font-size:16px; color:#000; } .mioot_prechatmsg3{ margin:5px 0 0 16px; clear:both;padding-top:10px; font-size:15px; color:#000;} .mioot_prechatmsg4{ clear:both; margin:15px 0 0 92px;} .mioot_prechatmsg6{font-size:17px; font-weight:bold; margin:0px 0 0 16px; color:#000; padding-top:22px;} .mioot_prechatmsg7{ clear:both; margin:23px 0 0 92px;} .mioot_error{padding-left:95px; font-size:11px !important; width:200px; float:left; color:#F00; display:none;height: 5px;}  .mioot_fieldName{text-align:right; width:67px; float:left; font-size:17px;  font-weight:bold; color:#181818; padding-top:3px; } .mioot_field{ padding-left:10px;text-align:right; width:180px; height:29px; float:left;} .mioot_text{ height:25px; width:180px; font-size:14px; padding-left:5px; border:#c9c9c9c;} .mioot_prechatbtn{height:39px; width:180px; cursor:pointer; }   #mioot_chat{clear:both; height:348px; width:465px; display:inline-block; } #mioot_chatBody{margin-top:5px; height:343px; } #mioot_left{ margin-left:10px; height:343px; width:290px;  float:left;} .mioot_chatinner{} .mioot_product{ height:24px;width:280px;font-family:Calibri, Arial; font-size:15px; font-weight:bold; border-bottom: 1px solid #ccc; white-space: nowrap;overflow:hidden;text-overflow:ellipsis; } .mioot_chatmsg{height:260px; width:290px;  overflow:auto; overflow-x:hidden;} .mioot_chatmsgAlert{height:208px; width:290px; overflow:auto;overflow-x:hidden; margin-bottom:5px;}  .mioot_agent{float:left; margin-top:5px; width:285px; overflow: hidden;} .mioot_agent_name{font-family:Arial;font-size:16px;color:#FFFFFF; font-weight:normal;width:34px;height:36px; text-align:center; padding:8px 0 0 0; top:0; } .mioot_agent_msg{ float:left;  width:230px;  } .mioot_agent_text{ width:auto; max-width:225px; display:inline-block; font-family:Arial;font-size:13px; color:#848484; background:#FFF; border: 1px solid #E3E3E3;padding:3px;border-top-color: transparent;border-left-color: transparent;   border-radius:1px; margin: 4px 0 0 0px; word-break:normal; word-wrap:break-word;} .mioot_agent_time{font-family:Arial;font-size:9px; color:#b0b0b0;   padding-bottom:5px;color:#666666; } .mioot_sys_div{ margin-top:2px;margin-left:2px; width:215px; float:left; } .mioot_sys_msg{float:left; display:inline; width:223px; line-height: 1; font-family:Arial; font-size:12px; color:#848484; } .mioot_sendbtn{ background-position: -66px 0; width: 45px; height: 32px; float:right; margin:4px 0px 0 0; cursor:pointer; } .mioot_visitor{clear:both; margin-top:5px; width:270px; } .mioot_visitor_name{text-align:center; font-family:Arial; float:right; font-size:16px; color:#FFFFFF; font-weight:normal;width:35px; height:36px;padding:8px 0 0 0;} .mioot_visitor_msg{width:230px; float:right;} .mioot_visitor_text{ float:right; width:auto; max-width:225px; font-family:Arial;font-size:13px; color:#848484; background:#FFF;border: 1px solid #E3E3E3;padding:3px;border-top-color: transparent;border-left-color:transparent; border-radius:1px; margin: 4px 0px 0 0;  word-break:normal; word-wrap:break-word;} .mioot_visitor_time{clear:both; width:200px; float:right; text-align:right;font-family:Arial;font-size:9px; color:#b0b0b0; padding-bottom:5px;  color:#666666; } .mioot_alert{height:49px; width:286px; font-family:Arial;font-size:13px; color:#bababa; background-color:#FFF; font-family:Calibri; font-size:13px; font-style:italic; color:#666; display:block; float:left; border-radius:2px; border: 1px solid #E3E3E3; border-top-color: transparent;border-left-color: transparent; display:none; } .mioot_alertImg{float:left; width:30px; padding:5px 0 0 5px;} .mioot_alertDisconnect{float:left; height:41px; width:238px; padding:2px; margin:2px 0 2px 0; vertical-align:middle;  overflow:auto;} .mioot_typing{clear:both;width:286px;  height:14px; } .mioot_typing_dot{ width:200px; height:10px; } #mioot_editor{width:286px; height:40px;  background-color:#fff; float:left; } .mioot_editor_active{border: 1px solid #009CCD;} .mioot_editor_inactive{border: 1px solid #dcdcdc;} #mioot_eleft{ width:240px; height:40px; float:left;} #mioot_eright{height:40px; float:left; display:block;} #mioot_typepad{height:35px;width:230px; font-family:Arial; font-size:12px; color:#848484; padding:2px 0 0 3px; border:none; overflow:auto; background-color:#fff; resize:none;}  .mioot_onActive{ font-family:Arial; font-size:12px; background-position: -724px 0; width: 160px; height: 30px;cursor:pointer; } .mioot_offActive{font-family:Arial; font-size:12px;  background-position: -380px 0; width: 160px; height: 30px; background-repeat:no-repeat;cursor:pointer; color:#999;} .mioot_online{font-family:Arial; font-size:12px; background-position: -885px 0; width: 160px; height: 23px;   cursor:pointer;} .mioot_offline{font-family:Arial; font-size:12px;background-position: -541px 0; width: 160px; height: 23px; cursor:pointer; color:#999;}   .mioot_wrap{margin:0px 0 0 25px; width:112px; white-space:nowrap; overflow:hidden;text-overflow:ellipsis; line-height:30px; vertical-align:middle;display:table-cell; float:left;} .mioot_wrap_inactive{margin:0px 0 0 25px; padding:2px 0 0 0; width:112px; white-space:nowrap; overflow:hidden;text-overflow:ellipsis; vertical-align:middle;display:table-cell; float:left;} .mioot_wrap_count{ margin:0px 0 0 25px; padding:2px 0 0 0; width:109px; white-space:nowrap; overflow:hidden;text-overflow:ellipsis; vertical-align:middle;display:table-cell; float:left; font-weight:bold;}  .mioot_close{cursor:pointer; margin:9px 0px 0 4px;} .mioot_close_inactive{cursor:pointer; margin:4px 0px 0 4px;} .mioot_chatMsgCount {margin:0px 3px 0 0;font-family:Arial; font-size:10px; text-align:center;color:#FFF;float:right; line-height:19px;} #mioot_right{margin-right:5px; width:160px; height:343px; float:left; } #mioot_skills{width:160px; height:343px; float:left;  background-image:url("'+imgPath+'skillOther_bg.png");} #mioot_skilllist{ height:308px; width:142px; float:left; } #mioot_maxChat_alert{ margin:5px 0px 0px 13px; padding:5px 0 0 0; width:142px; height:86px; font-family:Arial; font-size:13px; color:#BC282D; background-color:#F3F4F6; text-align:center; display:none; } #mioot_maxChat_alert_text{padding:5px 0 0 0; } #mioot_maxchat{width:142px; padding:5px 0px 0px 12px; font-family:Arial; font-size:11px; color:#a0a0a0; font-style:italic;line-height:1.2;} #mioot_survey{clear:both;padding:0 0 0 10px; height:25px; font-family:Arial; font-size:11px; color:#9c9c9c; display:table-cell; vertical-align:middle;} textarea, input {outline:none;} .miootOnline{float:left;height:21px; background-image:url("'+imgPath+'online.png"); font-family:Calibri; font-size:12px; color:#848484; background-repeat:no-repeat; padding-left:27px; vertical-align:middle; text-decoration:underline; cursor:pointer;} .miootOffline{float:left; height:21px; background-image:url("'+imgPath+'offline.png"); font-family:Calibri; font-size:12px; color:#848484; font-weight:bold; background-repeat:no-repeat; padding-left:27px; vertical-align:middle; text-decoration:underline; cursor:pointer;} .mioot_dep_name{width:223px;  white-space: nowrap;overflow:hidden;text-overflow:ellipsis;} #mioot_inner{ height:300px; width:290px;}';
mioot_css+="#mioot_min_div{ height:38px; width:200px; background-color:#FFF; border-radius: 2px 2px 0px 1px; -webkit-box-shadow: 1px 1px 5px 0px rgba(50, 50, 50, 1); -moz-box-shadow:1px 1px 5px 0px rgba(50, 50, 50, 1); box-shadow:1px 1px 5px 0px rgba(50, 50, 50, 1); border-top-left-radius:5px; border-top-right-radius:5px;  } .mioot-onoffText{ font-size:16px; color:#999; font-family:Calibri,Arial; padding:7px 3px 0 2px; float:left;} .mioot-maximize{ background-position: -309px 0; width: 23px; height: 17px;cursor:pointer; } .mioot-close2{ background-position: -112px 0; width: 18px; height: 16px; cursor:pointer; } .mioot-minclose{float:right; padding:7px 5px 0 0; } .mioot_popup {background: none repeat scroll 0 0 #FFFFFF;border-radius: 5px; box-shadow: 0 0 3px 2px rgba(0, 0, 0, 0.3); color: #333333; display: none; font-size: 13px; padding: 10px; z-index: 500; position: absolute !important;clear:both;top:150px; left:100px;} #mioot_chat_call{vertical-align: baseline;right:0px; bottom:30px; position: fixed; z-index:1001;} ";var chatWinDesign='<div id="mioot_max_div"><div id="mioot_title"><div id="mioot_logo" class=" mioot-img mioot-online-logo"> </div><div id="mioot_closer"><span id="mioot_minimize" class=" mioot-img mioot-minimize"></span><span id="mioot_top_close1" class="mioot-img mioot-close"></span></div></div>  <div id="mioot_prechat"><div id="mioot_prechatform" class="mioot_pchatlogged"><div id="mioot_prechatmsg" class="mioot_prechatmsg"></div><div class="mioot_prechatmsg1">'+cV.prechat_msg1+'</div><div class="mioot_prechatmsg2">'+cV.prechat_msg2+'</div><div id="mioot_guestform"></div></div></div>    <div id="mioot_chat"><div id="mioot_chatBody"><div id="mioot_left"><div id="mioot_inner" class="mioot_chatinner"></div><div id="mioot_editor" class="mioot_editor_active"><div id="mioot_eleft"><textarea id="mioot_typepad" placeholder="Send a message ..." disabled="disabled" onkeydown="miootChat.edKeyPress(event);"  onkeyup="miootChat.edKeyPress(event,this);"></textarea></div><div id="mioot_eright"> <span id="mioot_btn_send" class="mioot-img mioot_sendbtn"></span> </div></div></div><div id="mioot_right"><div id="mioot_skills"><div id="mioot_skilllist"><div id="mioot_skill_online"></div><div id="mioot_skill_offline"> </div>     <div id="mioot_maxChat_alert"><span class="mioot-img mioot-error"></span><div id="mioot_maxChat_alert_text">You can chat with maximum of 4 sellers <br />at a time</div></div></div><div id="mioot_maxchat">You can chat with maximum of 4 sellers at a time.</div></div></div></div><div id="mioot_survey"></div></div></div></div><div id="mioot_min_div"><div class="mioot-img mioot-onoffLogo"></div><div class="mioot-minclose"><span id="mioot_maximize" class="mioot-img mioot-maximize"></span><span id="mioot_top_close2" class="mioot-img mioot-close2"> </span></div></div>';Hash.remove=function(t,i){isNull(t[i])||delete t[i]},Hash.clear=function(t){for(var i in t)delete t[i]},miootFunctions={},miootFunctions.fn=miootFunctions.prototype={SnapdealOnOffMultiple:function(t){if(t.length>0){for(var i=0;i<t.length;i++)isNull(sCodes[t[i].skill_code])||(sArray[t[i].skill_id]=sCodes[t[i].skill_code],sArray[t[i].skill_id].skill_name=t[i].skill_name,skillGroup.changeImgTag(t[i].skill_id,t[i].skill_status));onOffPingStart(getKeys(sArray,",")),onLoad&&(L(),start(),setInterval(function(){removeScrTag()},1e4))}Hash.clear(sCodes)},onOffMultiple:function(t){var i="";t=t.onoffmultiple;for(var i in sArray)isNull(t[i])||skillGroup.changeImgTag(i,t[i]),isNull(VISITORs[i])||(vObj=getVisitor(i),1==t[i]||7!=vObj.visitor_status&&8!=vObj.visitor_status&&9!=vObj.visitor_status||chatEndProcess(VISITORs[i]),1==t[i]?setHTML(EID(zz+"chat_again_"+i),cAgain()):setHTML(EID(zz+"chat_again_"+i),""))},snapDealPreChatdata:function(t){try{!isNull(t.visitor_id)&&t.visitor_id>0&&(vObj=getVisitor(t.skill_id),vObj.skill_id=t.skill_id,vObj.contact_id=t.contact_id,vObj.visitor_id=t.visitor_id,vObj.session_id=t.session_id,set(vObj),1==sArray[t.skill_id].status&&visitorRequestChat(vObj),vPingStart())}catch(i){}},visitorRequestChat:function(t){try{if(2==t.visitor_status)return void this.blockVisitor(t);vObj=getVisitor(t.skill_id),vObj.visitor_status=t.visitor_status,vObj.req_time=LT(),this.processVStatus(t,vObj),disableTypepad(!1)}catch(i){}},processVStatus:function(t,i){return i.maxQPos=0,i.isChatStart=!1,welcomeMsg(i),vs=t.visitor_status,(7==vs||8==vs||9==vs||11==vs||15==vs)&&chatPingStart(),(7==vs||8==vs)&&(i.hcnt=1,holdingMessage("",0,i)),9==vs?void(i.maxQInt=setTimeout(function(){maxQRedirect(i)},1e3*i.cV.queue_waittime)):20==vs||21==vs?void QFullRedirect(i):void 0},visitorIsAccepted:function(t){try{if(!isNull(t.visitor_status)){if(2==t.visitor_status)return void this.blockVisitor(t);vObj=getVisitor(t.skill_id),isNull(vObj)&&(vObj=new ClassVisitor,addVisitor(t.skill_id,vObj));var i=vObj.visitor_status;vs=t.visitor_status,vObj.visitor_status=vs}if(set(vObj),10==vs||14==vs||15==vs||20==vs)if(clearInt(vObj.maxQInt),stopHolding(vObj),vObj.qp=0,15==vs)vObj.chat_id=t.chat_id,ACT_CHAT[t.chat_id]=vObj,vObj.isChatStart||this.startChatting(t,vObj);else if(10==vs)declineChat(vObj);else if((20==t.visitor_status||21==t.visitor_status)&&20!=i)return void QFullRedirect(vObj)}catch(e){}},blockVisitor:function(t){T("blocked","yes,"+LT(),1),clearInt(rInt),clearInt(t.vMaxQue),isNull(EID(zz+"mindiv"))||(EID(zz+"mindiv").innerHTML="")},snapDealVisitorPing:function(){T("lp",LT(),0)},visitorQueuePosition:function(t){try{if(!isNull(t.visitor_status)&&2==t.visitor_status)return void this.blockVisitor(t);if(vObj=getVisitor(t.skill_id),vObj.visitor_status=t.visitor_status,!isNull(t.responseMessage)){if(0==parseInt(t.responseMessage))return;isNull(EID(zz+"queue"+t.skill_id))?(vObj.qp=parseInt(t.responseMessage),avgQWT(vObj.agt,vObj.qp,vObj)):parseInt(t.responseMessage)!=vObj.QLength&&(hmsg=vObj.cV.loop_message.replace("{qlength}",t.responseMessage),sysMsg(vObj,hmsg)),vObj.QLength=parseInt(t.responseMessage),0==vObj.maxQPos&&(vObj.maxQPos=vObj.QLength)}}catch(i){}},startChatting:function(t,i){try{if(t.chat_id>0){i.chat_id=t.chat_id,i.operator_id=t.operator_id,i.added_on=t.added_on,i.long_addedon=t.longAddedOn,i.opMsgCount=0,i.isChatStart=!0;try{chatSettings(i),i.skill_id==selected_skill&&showRating(0)}catch(e){}""!=i.message&&(sendMsgInQ(i),showhideAlert(i.skill_id,""),i.message=""),disableTypepad(!1)}}catch(e){}finally{this.agentBufferCounter(i)}},visitorSendMessage:function(){},visitorgetChatMessage:function(t){try{for(var i="",e=!1,o=0;o<t.length;o++){i="";try{var s=t[o].message_type;vObj=ACT_CHAT[t[o].chat_id],vObj.long_addedon=t[o].longAddedOn,vObj.added_on=t[o].added_on,i=this.parseChatMessage(t[o],!1,vObj),""!=i&&(AddToBrowser(vObj.skill_id,i),22!=s&&(e=!0),(1==s||5==s||6==s||7==s)&&(++vObj.opMsgCount,clearTyping(vObj),this.responseCtrlOn(vObj,0),vObj.skill_id!=selected_skill&&(vObj.msgWait+=1,vObj.msgWait>99&&(vObj.msgWait=99),miootChat.showMsgCount(vObj.skill_id,vObj.msgWait))))}catch(a){}}e&&soundEnable&&EID(zz+"audio").play()}catch(a){}},parseChatMessage:function(t,i,e){cmsg="";var o=t.message_type,s=null;switch(o){case 1:case 3:cmsg=agentMsg(e.opfname,t.message);break;case 5:s=PushURL(e,t.message),cmsg=s[1],i||WinOpen(s[0]);break;case 6:cmsg=PushImage(e,t.message);break;case 7:s=t.message.split(","),cmsg=DLink(e,t.message,0);break;case 8:s=t.message.split(","),cmsg=agentMsg(e.opfname,replaceVars(e.cV.chat_forward_message,e).replace("{fwdagentname}","")),e.operator_id=t.sender_id;break;case 9:{t.sender_id}s=t.message.split(","),cmsg=agentMsg(e.opfname,replaceVars(e.cV.conference_join_message,e));break;case 10:cmsg=agentMsg(e.opfname,replaceVars(e.cV.conference_left_message,e));break;case 13:e.isTyping=1,opTyping(e);break;case 19:clearTyping(e);break;case 21:miootOFn.cancelPopup(zz+"popup_div");break;case 22:miootOFn.cancelPopup(zz+"popup_div");var a=mV.web_url+mV.partner_id+"/"+t.message;cmsg=DLink(a+","+t.message,1),e.message=a+",Uploaded",i||sendMsgToServer(e,7);break;case 16:case 17:case 23:chatEndResponse(e,0)}return cmsg},snapDealGetChatMessages:function(t){try{t=t.visitorsChatMessageBeanList;for(var i=new Array,e=0;e<t.length;e++)try{vs=t[e].visitor_status;var o=getSkillID(t[e].visitor_id);if(vObj=getVisitor(o),19==vs||20==vs||21==vs){clearCook(vObj),clearDetails(o);continue}if(i[t[e].visitor_id]=o,vObj.chat_id=t[e].chat_id,vObj.operator_id=t[e].operator_id,vObj.long_addedon=t[e].longupdated_on,vObj.added_on=t[e].updated_on,vObj.req_time=t[e].longupdated_on,vObj.server_time=t[e].server_timelong,ACT_SKILLs[o]=vObj,vObj.skill_status=1,vObj.rated=t[e].visitor_rating,this.saveChatDetails(vObj,t[e]),build(vObj),15==vObj.visitor_status&&!isNull(t[e].chatMessageBeanList)){ACT_CHAT[vObj.chat_id]=vObj;var s="",a="",n=!1;welcomeMsg(vObj),chatSettings(vObj),obj=t[e].chatMessageBeanList;for(var r=0;r<t[e].chatMessageBeanList.length;r++)try{vObj.long_addedon=obj[r].longAddedOn,vObj.added_on=obj[r].added_on,a=obj[r].message_type,s="",1==obj[r].senderType?(1==a?s=vMsg(vObj,obj[r].message):22==a&&(s=this.parseChatMessage(obj[r],!0,vObj)),AddToBrowser(vObj.skill_id,s),n=!1):0==obj[r].senderType&&13!=a&&14!=a&&19!=a&&22!=a&&(s=this.parseChatMessage(obj[r],!0,vObj),""!=s&&(AddToBrowser(vObj.skill_id,s),++vObj.opMsgCount),(1==a||5==a||6==a||7==a)&&(n=!0))}catch(l){}}}catch(l){}finally{15==vObj.visitor_status?(this.agentBufferCounter(vObj),n&&this.responseTimerStart(vObj)):continueChat(vObj)}for(var d in SKILL_MAP)isNull(i[d])&&(clearCook(getVisitor(SKILL_MAP[d])),Hash.remove(d))}catch(c){}chatPingStart(),isNull(EID(zz+"skill_"+S("tb")))?gotoFirst():miootChat.setFocus(S("tb"))},saveChatDetails:function(t,i){t.visitor_status=i.visitor_status,t.fname=i.first_name.charAt(0).toUpperCase(),t.first_name=i.first_name,t.skill_name=i.skill_name,t.prod_name=i.custom_field2,fn=t.first_name,email=t.email_id},visitorChatEnd:function(){},visitorOfflineSubmission:function(){},visitorAbandonedChat:function(){},addTicket:function(){},sendmsg:function(){sendmsg()},visitorChatRating:function(t){"Success : Visitor Chat Rating Updation"==t.responseMessage&&t.skill_id==selected_skill&&showRating(sVObj.rated)},responseTimerStart:function(t){var i=(t.server_time-t.long_addedon)/1e3,e=t.cV.response_interval+t.cV.response_endtime;i>0&&(i>=e?responseCtrlEnd(t):i<t.cV.response_interval?this.responseCtrlOn(t,i):this.responseCtrlWarn(t,e-i))},responseCtrlOn:function(t,i){1==t.cV.response_control&&(clearInt(t.rcTimer),t.rcTimer=setTimeout(function(){miootFunctions.fn.responseCtrlWarn(t,0)},1e3*(t.cV.response_interval-i)))},responseCtrlWarn:function(t,i){hmsg=replaceVars(t.cV.response_message,t),t.alertMessage=hmsg,showhideAlert(t.skill_id,hmsg),miootChat.setFocus(t.skill_id),t.rcTimer=setTimeout(function(){responseCtrlEnd(t)},1e3*(t.cV.response_endtime-i))},agentBufferCounter:function(t){clearInt(t.ticks),setTimeout(function(){t.ticks=t.cV.response_buffer_time+1},1e3*t.cV.response_buffer_time)}};var miootChat={Initialize:function(){insertCssMioot(mioot_css),skillGroup.getSkillIDs(skillMap)},Recreate:function(){clearInt(mInt),Hash.clear(sArray),skillGroup.getSkillIDs(skillMap)},saveMsg:function(t){t>0&&(getVisitor(t).message=EID(zz+"typepad").value)},setFocus:function(t){try{if(!isNull(EID(zz+"skill_"+t))){sVObj=getVisitor(t),sVObj.msgWait=0;var i=EID(zz+"skill_"+t);i.className=activeClass(sVObj.skill_status),EID(zz+"wrap_"+t).className=zz+"wrap",EID(zz+"close_"+t).className="mioot-img mioot-skill-close mioot_close",this.showClose(t),this.hideMsgCount(t),this.enableDisable(t),showhide(zz+"product_"+t,!0),t!=selected_skill&&this.saveMsg(selected_skill),selected_skill=t,scrollDown(EID(zz+"chat_"+t)),vs=sVObj.visitor_status,showRating(15==vs||sVObj.rated>0?sVObj.rated:-1),1==vs||15==vs||11==vs||13==vs||7==vs||8==vs||9==vs?(disableTypepad(!1),15==sVObj.visitor_status?(tIndStart(sVObj),opTyping(sVObj)):clearInt(tInt)):0!=sVObj.skill_status||sVObj.isSendOffline?disableTypepad(!0):(showRating(-1),disableTypepad(!1)),setTimeout(function(){try{EID(zz+"typepad").value=sVObj.message}catch(t){}},100),editor(""==sVObj.message?1:2),T("tb",selected_skill,0)}}catch(e){}},enableDisable:function(t){el=getElemByClass("skillinner");for(var i,e,o=0;o<el.length;o++){var s=el[o].getAttribute("skill");isNull(s)||(i="",e="",s!=t&&(EID(zz+"skill_"+s).className=inActiveClass(getVisitor(s).skill_status),EID(zz+"wrap_"+s).className=zz+"wrap_inactive",EID(zz+"close_"+s).className="mioot_close_inactive mioot-img mioot-skill-close",this.hideClose(s),showhide(zz+"product_"+s,!1)))}},AddOnline:function(t,i){var e=this.createObj(t,i);EID(zz+"skill_online").appendChild(e[0])},AddOffline:function(t,i){var e=this.createObj(t,i);EID(zz+"skill_offline").appendChild(e[0])},createObj:function(t,i){var e=createElem("div");e.id=zz+"skill_"+t,e.setAttribute("skill",t),e.setAttribute("class","skillinner");var o=createElem("div");o.id=zz+"wrap_"+t,o.setAttribute("class",zz+"wrap"),o.innerHTML=i,null!=o.title&&(o.title=i);var s=createElem("div");s.id=zz+"count_"+t,s.setAttribute("class",zz+"chatMsgCount mioot-img mioot-counter"),s.style.display="none";var a=createElem("div");return a.id=zz+"close_"+t,a.setAttribute("class",zz+"close mioot-img mioot-skill-close"),a.style.display="none",e.appendChild(o),e.appendChild(s),e.appendChild(a),this.tempAddEvents(a,o,t),[e,o,s,a]},tempAddEvents:function(t,i,e){t.addEventListener?(t.addEventListener("click",function(){miootChat.mioot_endChat(e)},!1),i.addEventListener("click",function(){miootChat.setFocus(e)},!1)):t.attachEvent&&(t.attachEvent("onclick",function(){miootChat.mioot_endChat(e)}),i.attachEvent("onclick",function(){miootChat.setFocus(e)}))},maxSeller:function(){showhide(zz+"maxChat_alert",!0)},showClose:function(t){EID(zz+"close_"+t).style.display="inline-block"},hideClose:function(t){showhide(zz+"close_"+t,!1)},showMsgCount:function(t,i){i>0?(EID(zz+"count_"+t).innerHTML=i,showhide(zz+"count_"+t,!0),EID(zz+"wrap_"+t).className=zz+"wrap_count",EID(zz+"count_"+t).className="mioot_chatMsgCount mioot-img mioot-counter"):this.hideMsgCount(t)},hideMsgCount:function(t){EID(zz+"count_"+t).innerHTML="",showhide(zz+"count_"+t,!1)},addSkill:function(t,i,e){hmsg="",isNull(EID(zz+"skill_"+t))&&(1==e?miootChat.AddOnline(t,i):miootChat.AddOffline(t,i),this.createChatDiv(t))},createChatDiv:function(t){try{var i=EID(zz+"product"+t);isNull(i)&&(hmsg='<div id="'+zz+"product_"+t+'" class="'+zz+'chatcall" skill='+t+' style="position:relative;display:none;"><div class="'+zz+'product">'+getVisitor(t).prod_name+'</div><div id="'+zz+"chat_"+t+'" class="'+zz+'chatmsg"></div><div id="'+zz+"alert_"+t+'" class="'+zz+'alert"><div class="mioot_alertImg"><span class="mioot-img mioot-alert_bubble"> </span> </div><div id="'+zz+"alert_msg"+t+'"  class="'+zz+'alertDisconnect" ></div></div><div id="'+zz+"typing_"+t+'" class="'+zz+'typing"></div></div>',EID(zz+"inner").innerHTML+=hmsg)}catch(e){}},removeChatDiv:function(t){try{remElement(EID(zz+"product_"+t)),remElement(EID(zz+"skill_"+t)),clearDetails(t),t==selected_skill&&(selected_skill=0),gotoFirst()}catch(i){}},mioot_endChat:function(t){vObj=getVisitor(t),11!=vObj.visitor_status&&confirm(aL.A12)&&chatEndProcess(vObj)},topClose:function(){if(confirm(aL.A12)){try{T("sk","",0);for(key in VISITORs)chatEndProcess(getVisitor(key))}catch(t){}setTimeout(function(){closeWin()},200),clearInt(pingInt)}},setMinMax:function(t){1==t?(showhide(zz+"max_div",!0),showhide(zz+"min_div",!1)):(showhide(zz+"max_div",!1),showhide(zz+"min_div",!0))},showPrechat:function(t,i){hsmg="",pSkill=t,1==i?(hsmg='<div class="'+zz+'prechatmsg3">'+cV.prechat_msg3+'</div><form id="'+zz+'frm"> <div class="'+zz+'prechatmsg3"><div class="'+zz+'fieldName">Name:</div><div class="'+zz+'field"><input err="'+zz+'err_first_name" type="text" name="'+zz+'first_name" onblur="return miootOFn.validInput(this,3);" onkeyup="miootOFn.limitThis(event,this,50);if(miootOFn.isEnter(event)) miootOFn.Validations('+i+');return false; return" class="'+zz+'text"/></div></div><div id="'+zz+'err_first_name" class="'+zz+'error"></div>',hsmg+='<div class="'+zz+'prechatmsg3"><div class="'+zz+'fieldName">Email ID:</div><div class="'+zz+'field"><input err="'+zz+'error_email" type="text" name="'+zz+'email" onblur="return miootOFn.validInput(this,4);" onkeyup=" miootOFn.limitThis(event,this,50);if(miootOFn.isEnter(event)) miootOFn.Validations('+i+');return false;" class="'+zz+'text" /></div></div></div><div id="'+zz+'error_email" class="'+zz+'error"></div>',hsmg+='<div class="mioot_prechatmsg4 mioot_prechatbtn mioot-img mioot-start-chat" onClick="return miootOFn.Validations('+i+');"></div>',EID(zz+"prechatmsg").innerHTML="Hello,",EID(zz+"prechatform").setAttribute("class",zz+"pchatguest")):(hsmg+='<div class="mioot_prechatmsg7 mioot_prechatbtn mioot-img mioot-start-chat" onClick="return miootOFn.Validations('+i+');"></div>',EID(zz+"prechatform").setAttribute("class",zz+"pchatlogged"),EID(zz+"prechatmsg").setAttribute("class",zz+"prechatmsg6"),EID(zz+"prechatmsg").innerHTML="Dear "+sArray[pSkill].buyName+","),EID(zz+"guestform").innerHTML=hsmg,EID(zz+"guestform").style.display="inline-block",showhide(zz+"chat",!1),showhide(zz+"prechat",!0)},onOffClick:function(t){return showhide(zz+"chat_call",!0),isChatted?isNull(EID(zz+"skill_"+t))&&getElemByClass(zz+"chatcall").length>=maxChat?(this.setMinMax(1),miootChat.maxSeller(),void setTimeout(function(){showhide(zz+"maxChat_alert",!1)},2e3)):isNull(EID(zz+"skill_"+t))?void this.addChat(t,!0):(this.setMinMax(1),void miootChat.setFocus(t)):(""==sArray[t].buyEmail||""==sArray[t].buyName?this.showPrechat(t,1):this.showPrechat(t,2),void this.setMinMax(1))},addChat:function(t,i){vObj=new ClassVisitor,vObj.skill_status=sArray[t].status,addVisitor(t,vObj),1==sArray[t].status&&(doCheck(t),vObj.visitor_id>0&&vObj.session_id>0?getMultiChatMessages(par(vObj)):(build(vObj),sendPreChat(vObj))),i&&miootChat.setFocus(t)},changeStatus:function(t){var i=EID(zz+"skill_"+t);isNull(i)||VISITORs[t].isSendOffline||(this.moveOnline(t),miootChat.addChat(t,!1),this.setFocus(selected_skill))},moveOnline:function(t){remElement(EID(zz+"skill_"+t)),miootChat.AddOnline(t,sArray[vObj.skill_id].skill_name)},edKeyPress:function(t){var i=t.keyCode?t.keyCode:t.which;13!=i||t.shiftKey?editor(fulltrim(EID(zz+"typepad").value).length>0?2:1):(t.preventDefault?t.preventDefault():t.returnValue=!1,sendmsg())},chatAgain:function(){selected_skill>0&&(EID(zz+"chat_"+selected_skill).innerHTML="",showhideAlert(selected_skill,""),disableTypepad(!1),vObj=getVisitor(selected_skill),vObj.chat_id=0,vObj.hcnt=1,vObj.ticks=0,vObj.elapsed=0,vObj.maxQPos=0,vObj.msgWait=0,vObj.req_time=0,vObj.rated=0,vObj.opMsgCount=0,vObj.dcr=0,visitorRequestChat(vObj),showRating(-1))},redirect:function(){location.replace("http://www.google.com")}},miootOFn={Validations:function(t){if(1==t){var i=EID(zz+"frm"),e=i[zz+"first_name"];if(!this.validInput(e,3))return!1;if(e=i[zz+"email"],!this.validInput(e,4))return!1;fn=fulltrim(i[zz+"first_name"].value),email=fulltrim(i[zz+"email"].value)}showhide(zz+"prechat",!1),showhide(zz+"chat",!0),miootChat.addChat(pSkill,!0)},showAlert:function(t){divObj=EID(zz+"popup_div"),isNull(divObj)||(divObj.innerHTML="",divObj.innerHTML+='<div style="text-align:center">'+t+'</div><div style="text-align:center"><input value="OK" id="'+zz+'btn_ok" onclick="miootOFn.cancelPopup(\'mioot_popup_div\');" type="button"></div>',divObj.style.display="block")},cancelPopup:function(t){isNull(EID(t))||showhide(t,!1)},rateThis:function(t){(15==sVObj.visitor_status||19==sVObj.visitor_status)&&(sVObj.rated=t,vSendRating(sVObj,t))},limitThis:function(t,i,e){var o=t.which?t.which:t.keyCode?t.keyCode:0;if(13==o||37==o||39==o||97==o&&o.ctrlKey)return!0;var s=fulltrim(i.value);return(8==o||46==o)&&(s-=1),isMaxLenExceed(s,e)?(dispErr(i.getAttribute("err"),aL.A7+"("+e+" characters only)"),s.length<e+1):(dispErr(i.getAttribute("err"),""),!0)},isEnter:function(t){var i=t.which?t.which:t.keyCode?t.keyCode:0;return 13==i?!0:!1},isValidType:function(t,i){var e="";if(i=fulltrim(i),""!=i)if(3==t){if(e=/^[A-Za-z\d\s]+$/,!e.test(i))return!1}else if(4==t&&(e=/\S+@\S+\.\S+/,!e.test(i)))return!1;return!0},validInput:function(t,i){var e=t.getAttribute("err");return""==fulltrim(t.value)?(dispErr(e,aL.A1),!1):miootOFn.isValidType(i,t.value)?!0:(3==i?dispErr(e,aL.A6):4==i&&dispErr(e,aL.A3),!1)}},skillGroup={getSkillIDs:function(t){sCodes={};for(var i=elemByClass("miootOnOff","div"),e="",o="",s="",a="",n="",r="",l=0;l<i.length;l++)try{var d=i[l];e=d.id,o=d.getAttribute("productId"),s=d.getAttribute("productName"),a=d.getAttribute("buyerEmail"),n=d.getAttribute("buyerName"),isNull(a)&&(a=""),isNull(n)&&(n=""),sCodes[e]={scode:e,prodId:o,prodName:s,buyEmail:a,buyName:n,status:0,skill_name:""},r+=e+","}catch(c){}t(r.replace(/,(\s+)?$/,""))},changeImgTag:function(t,i){try{i=1==i?1:0,sArray[t].status=i;var e=EID("miootImgTag_"+t);isNull(e)&&(e=skillGroup.createImage(t,""),EID(sArray[t].scode).appendChild(e)),1==i?(e.className="mioot-img miootOnline",e.innerHTML="Chat with Seller",e.style.display="block"):(e.className="mioot-img miootOffline",e.innerHTML="We are offline",e.style.display="none")}catch(o){}},createImage:function(t){var i=document.createElement("div");return i.id="miootImgTag_"+t,i.setAttribute("onclick","miootChat.onOffClick("+t+")"),i}};window.miootFunctions=miootFunctions,window.miootChat=miootChat,window.miootOFn=miootOFn;

})(window);
